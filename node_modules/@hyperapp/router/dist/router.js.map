{"version":3,"sources":["dist/router.js"],"names":["global","factory","exports","module","require","define","amd","router","hyperapp","this","createMatch","isExact","path","url","params","trimTrailingSlash","len","length","slice","location","state","pathname","window","previous","actions","go","history","pushState","set","data","subscribe","handleLocationChange","e","detail","unwrap","keys","reduce","next","key","fn","title","call","dispatchEvent","CustomEvent","wrapHistory","addEventListener","removeEventListener","Link","props","children","to","href","onclick","button","altKey","metaKey","ctrlKey","shiftKey","target","currentTarget","origin","preventDefault","h","Route","match","options","exact","paths","split","urls","i","decodeURI","_","parseRoute","parent","render","Switch","Redirect","replaceState","from"],"mappings":"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","sourcesContent":["(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('hyperapp')) :\n\ttypeof define === 'function' && define.amd ? define(['exports', 'hyperapp'], factory) :\n\t(factory((global.router = {}),global.hyperapp));\n}(this, (function (exports,hyperapp) { 'use strict';\n\nfunction Link(props, children) {\n  var to = props.to;\n  var location = props.location || window.location;\n\n  props.href = to;\n  props.onclick = function(e) {\n    if (\n      e.button !== 0 ||\n      e.altKey ||\n      e.metaKey ||\n      e.ctrlKey ||\n      e.shiftKey ||\n      props.target === \"_blank\" ||\n      e.currentTarget.origin !== location.origin\n    ) {\n    } else {\n      e.preventDefault();\n\n      if (to !== location.pathname) {\n        history.pushState(location.pathname, \"\", to);\n      }\n    }\n  };\n\n  return hyperapp.h(\"a\", props, children)\n}\n\nfunction createMatch(isExact, path, url, params) {\n  return {\n    isExact: isExact,\n    path: path,\n    url: url,\n    params: params\n  }\n}\n\nfunction trimTrailingSlash(url) {\n  for (var len = url.length; \"/\" === url[--len]; );\n  return url.slice(0, len + 1)\n}\n\nfunction parseRoute(path, url, options) {\n  if (path === url || !path) {\n    return createMatch(path === url, path, url)\n  }\n\n  var exact = options && options.exact;\n  var paths = trimTrailingSlash(path).split(\"/\");\n  var urls = trimTrailingSlash(url).split(\"/\");\n\n  if (paths.length > urls.length || (exact && paths.length < urls.length)) {\n    return\n  }\n\n  for (var i = 0, params = {}, len = paths.length, url = \"\"; i < len; i++) {\n    if (\":\" === paths[i][0]) {\n      try {\n        params[paths[i].slice(1)] = urls[i] = decodeURI(urls[i]);\n      } catch (_) {\n        continue\n      }\n    } else if (paths[i] !== urls[i]) {\n      return\n    }\n    url += urls[i] + \"/\";\n  }\n\n  return createMatch(false, path, url.slice(0, -1), params)\n}\n\nfunction Route(props) {\n  var location = props.location || window.location;\n  var match = parseRoute(props.path, location.pathname, {\n    exact: !props.parent\n  });\n\n  return (\n    match &&\n    props.render({\n      match: match,\n      location: location\n    })\n  )\n}\n\nfunction Switch(props, children) {\n  return children[0]\n}\n\nfunction Redirect(props) {\n  var location = props.location || window.location;\n  history.replaceState(props.from || location.pathname, \"\", props.to);\n}\n\nfunction wrapHistory(keys) {\n  return keys.reduce(function(next, key) {\n    var fn = history[key];\n\n    history[key] = function(data, title, url) {\n      fn.call(this, data, title, url);\n      dispatchEvent(new CustomEvent(\"pushstate\", { detail: data }));\n    };\n\n    return function() {\n      history[key] = fn;\n      next && next();\n    }\n  }, null)\n}\n\nvar location = {\n  state: {\n    pathname: window.location.pathname,\n    previous: window.location.pathname\n  },\n  actions: {\n    go: function(pathname) {\n      history.pushState(null, \"\", pathname);\n    },\n    set: function(data) {\n      return data\n    }\n  },\n  subscribe: function(actions) {\n    function handleLocationChange(e) {\n      actions.set({\n        pathname: window.location.pathname,\n        previous: e.detail\n          ? (window.location.previous = e.detail)\n          : window.location.previous\n      });\n    }\n\n    var unwrap = wrapHistory([\"pushState\", \"replaceState\"]);\n\n    addEventListener(\"pushstate\", handleLocationChange);\n    addEventListener(\"popstate\", handleLocationChange);\n\n    return function() {\n      removeEventListener(\"pushstate\", handleLocationChange);\n      removeEventListener(\"popstate\", handleLocationChange);\n      unwrap();\n    }\n  }\n};\n\nexports.Link = Link;\nexports.Route = Route;\nexports.Switch = Switch;\nexports.Redirect = Redirect;\nexports.location = location;\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\n})));\n//# sourceMappingURL=router.js.map\n"]}